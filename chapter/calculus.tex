\chapter{多元微积分 Multivariable calculus}

\section{矩阵方程和平面方程Square Systems}

定义三维空间的平面方程为: $ ax+by+cz=d $.

平面方程的确定:

1.已知平面过原点, 其法向量为$ \vv{N}=(1,5,10) $, 求平面方程.

取平面内任一点$ P=(x,y,z) $, 必有$ \vv{OP} \perp \vv{N} $,

\begin{equation}
\begin{aligned}
&\Leftrightarrow \vv{OP}\cdot\vv{N} = 0 \\
&\Leftrightarrow x+5y+10z=0
\end{aligned}
\end{equation}

2.已知平面过点$ P_0=(2,1,-1) $, 其法向量为$ \vv{N}=(1,5,10) $, 求平面方程.

故技重施, 此时$ \vv{P_0 P} \perp \vv{N} $,

\begin{equation}
\begin{aligned}
&\Leftrightarrow \vv{P_0 P}\cdot\vv{N} = 0 \\
&\Leftrightarrow (x-2)+5(y-1)+10(z+1)=0 \\
&\Leftrightarrow x+5y+10z=-3
\end{aligned}
\end{equation}

3.已知$ \vv{V}=(1,2,-1) $, 平面$ x+y+3z=5 $, 求矢量与平面的几何关系.

涉及到平面方程时, 法向量永远是最重要的, 方程的系数就是平面的法向量. 所以此平面法向量为$ \vv{N}=(1,1,3) $, 显然$ \vv{V}\cdot \vv{N}=0 $, 矢量与法向量正交, 与平面平行.

\subsection{线性方程组的几何解释}

有线性系统如下所示,

\begin{equation}
\begin{cases}
& x+z=1 \\
& x+y=2 \\
& x+2y+3z=3
\end{cases}
\end{equation}

每个方程表示一个平面, 其中两个平面可以相交于一条直线, 三个平面可以交于一点, 当方程组满足三个平面交于一点时, 线性方程组存在唯一解.

$ Ax=b $的解不存在是因为$ \inv{A} $不总是存在, 根据逆矩阵的定义, 显然当$ \det(A)\ne 0 $时, $ \inv{A} $才存在.

\begin{equation}
\inv{A} = \frac{1}{\det(A)}\adj{A}
\end{equation}

常数项的几何意义：对方程$ x+y+z=0/1/2/\cdots $, 不同的常数项代表将平面平移的距离.

如果有线性系统$ Ax=0 $, 称其为齐次(homogeneous)方程组, 其总有平凡解(rivial solution) $ \vv{x}=(0,0,0) $, 因为方程组的所有方程均过原点.

一般的, 对线性系统$ Ax=b $来说, 如果$ \det(A)\ne 0 $, 则方程组存在唯一解$ x=\inv{A}b $; 若$ \det(A) = 0 $, 则方程组无解或存在无穷多解.

\section{参数方程Parametric Equations}

直线可以看作两个平面的交集, 也可以看作点随时间运动的轨迹, 于是可以用$ x(t) $, $ y(t) $来描述直线方程. 给定两点$ Q_0=(-1,2,2) $和$ Q_1=(1,3,-1) $分别是$ t=0 $和$ t=1 $时点的坐标, $ Q_t $是$ t $时刻点的坐标, 显然有,

\begin{equation}
\vv{Q_0 Q_t}=t\vv{Q_0 Q_1}
\end{equation}

将$ Q_0 $和$ Q_1 $点坐标带入, 得,

\begin{equation}
\begin{cases}
& x_t + 1 = t \\
& y_t - 2 = t \\
& z_t - 2 = -3t
\end{cases}
\end{equation}

轨迹点坐标可写作$ Q_t=Q_0 + t\vv{Q_o Q_1} $, 该轨迹称为参数方程.

\begin{equation}
\begin{aligned}
& x_t = -1 + t \\
& y_t = 2 + t \\
& z_t = 2 - 3t
\end{aligned}
\end{equation}

\subsection{参数方程的应用}

1.给定一个平面$ x+2y+4z=7 $, 求$ Q_0 $和$ Q_1 $与平面的相对位置. 将$ Q_0 $带入方程，结果$ >7 $; $ Q_1 $带入后结果$ <7 $, 显然两点在平面的异侧. 直接将参数方程$ Q_t $中的各项带入平面方程, 解得$ t=0.5 $即得直线与平面得交点. 如若方程无解或有无穷多解, 则直线与平面平行或直线在平面内.

2.自行车轮子形成得摆线方程. $ P $是车轮边缘的一点，初始态在原点, 车轮半径为$ r $, 轮子沿着$ x $轴滚动, $ P $点的轨迹$ (x,y) $即为摆线. 那么怎么来描述此轨迹呢?

如所示, 向量$ \vv{OP} $转化成3个简单向量的相加, 易得,

\begin{equation}
\vv{OP}=\vv{OA}+\vv{AB}+\vv{BP}
\end{equation}

将$ \vv{OA}=(r\theta, 0) $, $ \vv{AB}=(0, r) $, $ \vv{BP}=(-a\sin\theta, -a\cos\theta) $带入, 得,

\begin{equation}
\vv{OP}=(r\theta-r\sin\theta, r-r\cos\theta)
\end{equation}

\section{开普勒第二定律Kepler's Second Law}

高中物理研究都是简单运动情况, 所以没有用到微积分, 实际中的运动复杂的多, 必须掌握矢量微积分才能解决问题.

速率是标量, 速度是矢量, 其大小为速率, 方向为物体运动的方向,

\begin{equation}
\vv{v}=\df{\vv{r}}{t}=\left( \df{x}{t}, \df{y}{t}, \df{z}{t} \right)
\end{equation}

同样, 加速度也是矢量, 定义为速度的导数,

\begin{equation}
\vv{a}=\df{\vv{v}}{t}
\end{equation}

弧长$ s $表示轨迹走的距离, 定义速率为,

\begin{equation}
|\vv{v}|=\df{s}{t}
\end{equation}

轨迹切向方向的单位矢量方向与$ \vv{v} $相同, 缩放$ \vv{v} $到一个单位得到切向单位矢量,

\begin{equation}
\hat{T}=\frac{\vv{v}}{|\vv{v}|}
\end{equation}

用链式求导法则, 得,

\begin{equation}
\vv{v}=\df{\vv{r}}{t}=\df{\vv{r}}{s} \df{s}{t}=\hat{T} \df{s}{t}
\end{equation}

其中, 向量$ d\vv{r} $和标量$ ds $的关系如 所示,

故,

\begin{equation}
\Delta \vv{r} \approx \hat{T}\Delta s = \vv{v}\Delta t
\end{equation}

开普勒行星运动第二定律, 也称等面积定律, 指的是太阳系中太阳和运动中的行星的连线在相等的时间内扫过的面积相等. 在$ \Delta t $时间内扫过的面积为,

\begin{equation}
A\approx \frac{1}{2}|\vv{r} \times \Delta \vv{r}| \approx \frac{1}{2}|\vv{r}\times \vv{v}|\Delta t
\end{equation}

由开普勒第二定律可得,

\begin{equation}
|\vv{r}\times \vv{v}|=\text{const}
\end{equation}

又, 行星运动在一个平面上, 所以叉乘所得为向量方向和大小均不变.

\begin{equation}
\begin{aligned}
&\Leftrightarrow \df{\vv{r}\times\vv{v}}{t}=
\df{\vv{r}}{t}\times\vv{v}+\df{\vv{v}}{t}\times\vv{r}=0 \\
&\Leftrightarrow \vv{v}\times\vv{v}+\vv{a}\times\vv{r}=0 \\
&\Leftrightarrow \vv{a}\times\vv{r}=0
\end{aligned}
\end{equation}

\section{偏导数Partial Derivatives}

固定$ y $, 让$ x $变化就是对$ x $的偏导数. 偏导数定义为,

\begin{equation}
\parf{f}{x} = \lim_{h\rightarrow 0} \frac{f(x+h,y)-f(x,y)}{h}
\end{equation}

切平面: 利用$ x $的偏导数可以找到某点的切线$ L_1 $, 利用$ y $的偏导数也可以找到一条切线$ L_2 $. 这两条切线确定的平面就是切平面.

\begin{equation}
\parf{f}{x}(x_0,y_0)=a \Rightarrow L_1=
\begin{cases}
z=z_0+a(x-x_0) \\
y=y_0
\end{cases}
\end{equation}

\begin{equation}
\parf{f}{y}(x_0,y_0)=a \Rightarrow L_2=
\begin{cases}
z=z_0+b(y-y_0) \\
x=x_0
\end{cases}
\end{equation}

切平面方程为:

\begin{equation}
z=z_0+a(x-x_0)+b(y-y_0)
\end{equation}

如果$ x $和$ y $均有所扰动, 函数值是如何变化的呢? 定义全增量为,

\begin{equation}
\Delta z\approx f_x \Delta x+f_y \Delta y
\end{equation}

对比全增量和切平面公式, 可以发现切平面是函数很好的近似, 即切平面和函数考得很近.

\section{极值和最小二乘法Max-Min and Least Squares}

极值必要条件: 设二元函数$ f(x,y) $在点$ (x_0,y_0) $的偏导数存在, 且该点为极值点, 必有$ (f_x, f_y)|_{(x_0, y_0)} = 0 $. 这里强调是必要条件, 因为两个偏导数存在且均为$ 0 $的点可能是鞍点(根据你选取的方向, 鞍点可能是局部最大, 也可能是局部最小).

最小二乘法, 给定一组数据点$ (x_1,y_1), (x_2,y2), \cdots, (x_n,y_n) $. 拟合一条能描述这些数据点的最佳函数$ y=ax+b $.

记每点与拟合值的误差为,

\begin{equation}
y_i-(ax_i+b)
\end{equation}

求最佳的拟合函数转化为如下优化问题,

\begin{equation}
\text{minimize}: D=\sum_{i=1}^n\left[y_i-(ax_i+b)\right]^2
\end{equation}

求函数$ D $的极值即可求得最佳拟合函数. 对$ x $和$ y $分别求偏导数并将其置于$ 0 $, 得到需要求解的方程组,

\begin{equation}
\begin{aligned}
\parf{D}{a}=\sum_{i=1}^{n}2(y_i-(ax_i+b)(-x_i)=0 \\
\parf{D}{b}=\sum_{i=1}^{n}2(y_i-(ax_i+b))(-1)=0
\end{aligned}
\end{equation}

\begin{equation}
\begin{cases}
\sum_{i=1}^{n}(ax_i^2+bx_i-x_iy_i)=0 \\
\sum_{i=1}^{n}(ax_i+b-y_i)=0
\end{cases}
\end{equation}



\section{二阶导数检验Second Derivative Test}

\section{链式法则Chain Rule}

\section{梯度Gradient}

\section{拉格朗日乘数法Lagrange Multipliers}


